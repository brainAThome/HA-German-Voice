# ================================================================================
# HA-GERMAN-VOICE - Deutsche Rolladen/Jalousie-Sprachbefehle
# ================================================================================
# TRUE STATE OF THE ART - Home Assistant 2024+ Syntax
# ✅ Entity Slots mit type: entity + domain filtering
# ✅ Area Slots mit type: area
# ✅ Responses direkt in Sentences
# ✅ Wildcard Entity Matching
# ================================================================================

language: de

# ============================================================================
# EXPANSION RULES
# ============================================================================
expansion_rules:
  cover_type: "(rolladen|rollo|jalousie|rollade|raffstore|plissee|markise|sonnenschutz|verdunklung)"
  cover_types: "(rolladen|rollos|jalousien|rolläden|raffstores|plissees|markisen)"
  article: "[der|die|das|den|dem]"
  room_prep: "(in|im|am|vom|beim|fürs|für das|für den|für die)"
  action_open: "(auf|hoch|rauf|öffnen|oeffnen|aufmachen|hochfahren|hochziehen|aufziehen)"
  action_close: "(zu|runter|ab|schließen|schliessen|zumachen|runterfahren|runterziehen|absenken)"
  action_stop: "(stopp|stop|halt|anhalten|stehen bleiben)"
  polite: "[bitte|mal|doch|eben]"
  polite_question: "(könntest|koenntest|kannst|würdest|wuerdest|magst) du [bitte|mal]"

# ============================================================================
# LISTEN
# ============================================================================
lists:
  position:
    values:
      - in: "(0|null|zu|geschlossen|ganz zu|komplett zu)"
        out: 0
      - in: "(5|fünf)"
        out: 5
      - in: "(10|zehn)"
        out: 10
      - in: "(15|fünfzehn)"
        out: 15
      - in: "(20|zwanzig)"
        out: 20
      - in: "(25|fünfundzwanzig|viertel)"
        out: 25
      - in: "(30|dreißig|dreissig)"
        out: 30
      - in: "(33|drittel|ein drittel)"
        out: 33
      - in: "(40|vierzig)"
        out: 40
      - in: "(50|fünfzig|fuenfzig|halb|halbe|zur hälfte|zur haelfte)"
        out: 50
      - in: "(60|sechzig)"
        out: 60
      - in: "(66|zwei drittel)"
        out: 66
      - in: "(70|siebzig)"
        out: 70
      - in: "(75|fünfundsiebzig|dreiviertel)"
        out: 75
      - in: "(80|achtzig)"
        out: 80
      - in: "(85|fünfundachtzig)"
        out: 85
      - in: "(90|neunzig)"
        out: 90
      - in: "(95|fünfundneunzig)"
        out: 95
      - in: "(100|hundert|voll|ganz|komplett|offen|ganz auf|komplett auf|ganz offen)"
        out: 100

  tilt_position:
    values:
      - in: "(0|null|zu|geschlossen|dunkel|ganz zu)"
        out: 0
      - in: "(25|viertel|leicht|ein bisschen|etwas)"
        out: 25
      - in: "(50|halbe|mittel|zur hälfte)"
        out: 50
      - in: "(75|dreiviertel|fast offen)"
        out: 75
      - in: "(100|ganz|voll|offen|hell|ganz offen|komplett)"
        out: 100

# ============================================================================
# INTENTS MIT ENTITY/AREA SLOTS + RESPONSES
# ============================================================================
intents:
  # --------------------------------------------------------------------------
  # ROLLADEN ÖFFNEN
  # --------------------------------------------------------------------------
  HassOpenCover:
    data:
      # === Mit Entity-Name (HA matched automatisch gegen cover domain!) ===
      - sentences:
          # Einfache Formen
          - "{name} <action_open>"
          - "<article> {name} <action_open>"
          - "<action_open> <article> {name}"
          # Mit Verben
          - "(öffne|oeffne|mach|fahr) <polite> <article> {name} [(auf|hoch)]"
          - "(zieh|ziehe) <polite> <article> {name} (hoch|auf|rauf)"
          - "{name} <cover_type> <action_open>"
          - "<polite_question> <article> {name} (aufmachen|öffnen|hochfahren)"
          # Mit "ein/eine" Artikel
          - "[ein|eine] {name} <action_open>"
          - "(öffne|mach|fahr) <polite> [ein|eine|den|die|das] {name}"
          # Imperative ohne Artikel
          - "(öffne|oeffne|mach|fahr) {name}"
          - "{name} (öffnen|aufmachen|hochfahren)"
          # Natürliche Sätze
          - "[ich möchte] [das|die|den] {name} (öffnen|aufmachen|hochfahren)"
          - "mach [bitte] [das|die|den] {name} auf"
          - "fahr [bitte] [das|die|den] {name} hoch"
        slots:
          name:
            type: entity
            domain: cover
        response: "OK, {{ slots.name }} wird geöffnet."
      
      # === Mit Area (alle Cover im Raum) ===
      - sentences:
          - "<cover_type> <room_prep> {area} <action_open>"
          - "<article> <cover_type> <room_prep> {area} <action_open>"
          - "(öffne|mach|fahr) <polite> <article> <cover_type> <room_prep> {area} [(auf|hoch)]"
          - "<room_prep> {area} [<article>] <cover_type> <action_open>"
          - "<room_prep> {area} <action_open> [<article>] <cover_type>"
          - "<cover_type> <action_open> <room_prep> {area}"
          - "<polite_question> <article> <cover_type> <room_prep> {area} (aufmachen|öffnen|hochfahren)"
        slots:
          area:
            type: area
        response: "OK, Rolladen in {{ slots.area }} werden geöffnet."

  # --------------------------------------------------------------------------
  # ROLLADEN SCHLIESSEN
  # --------------------------------------------------------------------------
  HassCloseCover:
    data:
      # === Mit Entity-Name ===
      - sentences:
          # Einfache Formen
          - "{name} <action_close>"
          - "<article> {name} <action_close>"
          - "<action_close> <article> {name}"
          # Mit Verben
          - "(schließe|schliesse|mach|fahr) <polite> <article> {name} [(zu|runter)]"
          - "(zieh|ziehe) <polite> <article> {name} (runter|zu|ab)"
          - "(lass|lasse) <polite> <article> {name} (runter|ab)"
          - "(verdunkle|verdunkeln) <polite> <article> {name}"
          - "{name} (verdunkeln|abdunkeln|dunkel [machen])"
          - "{name} <cover_type> <action_close>"
          - "<polite_question> <article> {name} (zumachen|schließen|runterfahren)"
          # Mit "ein/eine" Artikel
          - "[ein|eine] {name} <action_close>"
          - "(schließe|mach|fahr) <polite> [ein|eine|den|die|das] {name} [zu|runter]"
          # Imperative ohne Artikel
          - "(schließe|mach) {name} [zu]"
          - "{name} (schließen|zumachen|runterfahren)"
          # Natürliche Sätze
          - "[ich möchte] [das|die|den] {name} (schließen|zumachen|runterfahren)"
          - "mach [bitte] [das|die|den] {name} zu"
          - "fahr [bitte] [das|die|den] {name} runter"
        slots:
          name:
            type: entity
            domain: cover
        response: "OK, {{ slots.name }} wird geschlossen."
      
      # === Mit Area ===
      - sentences:
          - "<cover_type> <room_prep> {area} <action_close>"
          - "<article> <cover_type> <room_prep> {area} <action_close>"
          - "(schließe|mach|fahr) <polite> <article> <cover_type> <room_prep> {area} [(zu|runter)]"
          - "<room_prep> {area} [<article>] <cover_type> <action_close>"
          - "<room_prep> {area} <action_close> [<article>] <cover_type>"
          - "(verdunkle|verdunkeln) <polite> <room_prep> {area}"
          - "<room_prep> {area} (verdunkeln|abdunkeln)"
          - "(mach|mache) <polite> <room_prep> {area} dunkel"
          - "{area} dunkel [machen]"
          - "<cover_type> <action_close> <room_prep> {area}"
        slots:
          area:
            type: area
        response: "OK, Rolladen in {{ slots.area }} werden geschlossen."

  # --------------------------------------------------------------------------
  # ROLLADEN STOPPEN
  # --------------------------------------------------------------------------
  HassStopCover:
    data:
      - sentences:
          - "<action_stop> <polite> <article> {name}"
          - "<article> {name} <action_stop>"
          - "{name} <action_stop>"
          - "(halte|stoppe) <polite> <article> {name} an"
        slots:
          name:
            type: entity
            domain: cover
        response: "OK, {{ slots.name }} gestoppt."
      
      - sentences:
          - "<action_stop> <polite> <article> <cover_type> <room_prep> {area}"
          - "<cover_type> <room_prep> {area} <action_stop>"
          - "<room_prep> {area} <article> <cover_type> <action_stop>"
        slots:
          area:
            type: area
        response: "OK, Rolladen in {{ slots.area }} gestoppt."

  # --------------------------------------------------------------------------
  # POSITION SETZEN
  # --------------------------------------------------------------------------
  HassSetCoverPosition:
    data:
      # === Mit Entity-Name ===
      - sentences:
          - "{name} [auf] {position} [prozent]"
          - "<article> {name} [auf] {position} [prozent]"
          - "{name} auf {position} [prozent] (setzen|stellen|fahren)"
          - "(setz|stell|fahr) <polite> <article> {name} auf {position} [prozent]"
          - "(mach|mache) <polite> <article> {name} [auf] {position} [prozent] [(auf|zu)]"
          - "{name} (zur hälfte|halb|halbwegs) [(auf|zu)]"
          - "{name} <cover_type> [auf] {position} [prozent]"
        slots:
          name:
            type: entity
            domain: cover
        response: "OK, {{ slots.name }} auf {{ slots.position or 50 }}%."
      
      # === Mit Area ===
      - sentences:
          - "<cover_type> <room_prep> {area} [auf] {position} [prozent]"
          - "<article> <cover_type> <room_prep> {area} [auf] {position} [prozent]"
          - "(setz|stell|fahr) <polite> <article> <cover_type> <room_prep> {area} auf {position} [prozent]"
          - "<room_prep> {area} [<article>] <cover_type> [auf] {position} [prozent]"
          - "<room_prep> {area} [<article>] [<cover_type>] {position} [prozent]"
          - "<cover_type> <room_prep> {area} (zur hälfte|halb)"
        slots:
          area:
            type: area
        response: "OK, Rolladen in {{ slots.area }} auf {{ slots.position or 50 }}%."

  # --------------------------------------------------------------------------
  # LAMELLEN/KIPPEN
  # --------------------------------------------------------------------------
  HassSetCoverTiltPosition:
    data:
      - sentences:
          - "(kipp|neig|stell) <polite> [die] lamellen [von|am|im] {name} auf {tilt_position} [prozent]"
          - "lamellen [von|am|im] {name} [auf] {tilt_position} [prozent]"
          - "{name} lamellen [auf] {tilt_position} [prozent]"
          - "(kipp|neig) <polite> <article> {name} [auf] {tilt_position} [prozent]"
          - "<article> {name} (kippen|neigen) [auf] {tilt_position} [prozent]"
          - "(lass|lasse) [etwas|ein bisschen] licht [rein|herein] {name}"
        slots:
          name:
            type: entity
            domain: cover
        response: "OK, Lamellen {{ slots.name }} auf {{ slots.tilt_position or 50 }}%."
      
      - sentences:
          - "<cover_type> <room_prep> {area} lamellen [auf] {tilt_position} [prozent]"
          - "<cover_type> <room_prep> {area} (kippen|neigen) [auf] {tilt_position} [prozent]"
          - "[etwas|ein bisschen] licht [rein|herein] <room_prep> {area}"
        slots:
          area:
            type: area
        response: "OK, Lamellen in {{ slots.area }} auf {{ slots.tilt_position or 50 }}%."

  # --------------------------------------------------------------------------
  # ALLE ROLLADEN
  # --------------------------------------------------------------------------
  HassOpenCover:
    data:
      - sentences:
          - "(öffne|mach|fahr) <polite> alle <cover_types> [(auf|hoch)]"
          - "alle <cover_types> <action_open>"
          - "<cover_types> überall <action_open>"
          - "überall <cover_types> <action_open>"
          - "überall [(die|alle)] <cover_types> (auf|hoch|öffnen)"
          - "alle <cover_types> (in allen räumen|überall|im ganzen haus) <action_open>"
          - "(mach|mache) <polite> überall (hell|licht)"
        response: "OK, alle Rolladen werden geöffnet."

  HassCloseCover:
    data:
      - sentences:
          - "(schließe|mach|fahr) <polite> alle <cover_types> [(zu|runter)]"
          - "alle <cover_types> <action_close>"
          - "<cover_types> überall <action_close>"
          - "überall <cover_types> <action_close>"
          - "(verdunkle|verdunkeln) <polite> (alles|überall|alle räume|das ganze haus)"
          - "(komplette|totale) verdunklung"
          - "(mach|mache) <polite> überall dunkel"
          - "alles dunkel [machen]"
        response: "OK, alle Rolladen werden geschlossen."

  # --------------------------------------------------------------------------
  # SONNENSCHUTZ
  # --------------------------------------------------------------------------
  SetSunProtection:
    data:
      - sentences:
          - "(sonnenschutz|beschattung) [aktivieren|an|ein] <room_prep> {area}"
          - "(aktiviere|starte) <polite> [den] sonnenschutz <room_prep> {area}"
          - "{area} (sonnenschutz|beschatten|beschattung)"
          - "<room_prep> {area} (sonnenschutz|beschattung) [an|ein|aktivieren]"
          - "(schütze|schuetz) <polite> <room_prep> {area} vor [der] sonne"
          - "sonne <room_prep> {area} [(raus|ausblenden|blocken)]"
          - "(zu viel|zuviel) sonne <room_prep> {area}"
          - "{area} [ist] zu hell"
          - "<room_prep> {area} [ist] zu hell"
          - "(mach|mache) <polite> <room_prep> {area} (schattiger|dunkler)"
        slots:
          area:
            type: area
        response: "OK, Sonnenschutz in {{ slots.area }} aktiviert."

  DisableSunProtection:
    data:
      - sentences:
          - "(sonnenschutz|beschattung) [deaktivieren|aus|ab] <room_prep> {area}"
          - "(deaktiviere|beende|stoppe) <polite> [den] sonnenschutz <room_prep> {area}"
          - "{area} sonnenschutz (aus|deaktivieren|beenden)"
          - "<room_prep> {area} sonnenschutz (aus|ab|deaktivieren)"
          - "[kein|keinen] sonnenschutz [mehr] <room_prep> {area}"
          - "(mehr|lass) licht [rein] <room_prep> {area}"
        slots:
          area:
            type: area
        response: "OK, Sonnenschutz in {{ slots.area }} deaktiviert."

  # --------------------------------------------------------------------------
  # AUTOMATIK
  # --------------------------------------------------------------------------
  EnableCoverAutomation:
    data:
      - sentences:
          - "<cover_type> automatik [an|ein|aktivieren] <room_prep> {area}"
          - "(aktiviere|starte) <polite> [die] <cover_type> automatik <room_prep> {area}"
          - "automatische <cover_type> steuerung <room_prep> {area}"
          - "{area} automatisch [steuern]"
          - "<room_prep> {area} [<cover_type>] auf automatik [stellen|setzen]"
        slots:
          area:
            type: area
        response: "OK, Automatik für {{ slots.area }} aktiviert."

  DisableCoverAutomation:
    data:
      - sentences:
          - "<cover_type> automatik [aus|ab|deaktivieren] <room_prep> {area}"
          - "(deaktiviere|beende|stoppe) <polite> [die] <cover_type> automatik <room_prep> {area}"
          - "manuelle <cover_type> steuerung <room_prep> {area}"
          - "{area} manuell [steuern]"
          - "<room_prep> {area} [<cover_type>] auf manuell [stellen|setzen]"
        slots:
          area:
            type: area
        response: "OK, Automatik für {{ slots.area }} deaktiviert, manueller Modus."

  # --------------------------------------------------------------------------
  # SZENEN/MODI
  # --------------------------------------------------------------------------
  SetCoverScene:
    data:
      # Morgen-Modus
      - sentences:
          - "(morgen|aufwach|aufsteh)(modus|szene) [(aktivieren|starten)]"
          - "[guten] morgen [modus|szene]"
          - "<cover_types> (morgens|morgen modus)"
          - "weck mich [mit licht|sanft]"
          - "aufwachen [(modus|szene)]"
          - "guten morgen [licht|sonnenschein]"
        response: "Guten Morgen! Rolladen werden geöffnet."
      
      # Nacht-Modus
      - sentences:
          - "(nacht|schlaf|schlafens)(modus|szene) [(aktivieren|starten)]"
          - "[gute] nacht [modus|szene]"
          - "<cover_types> (nachts|nacht modus)"
          - "alles (abdunkeln|verdunkeln|schließen) [zum schlafen]"
          - "schlafenszeit"
          - "ich gehe (schlafen|ins bett)"
          - "ab ins bett"
        response: "Gute Nacht! Alle Rolladen werden geschlossen."
      
      # Kino-Modus
      - sentences:
          - "(kino|film|heimkino|movie)(modus|szene) [(aktivieren|starten)]"
          - "[kino modus] (aktivieren|starten)"
          - "verdunkeln für (film|kino|filmabend)"
          - "(wir|ich) (schauen|gucken) [einen] film"
          - "filmabend"
        response: "Kino-Modus aktiviert. Viel Spaß beim Film!"
      
      # Lüften
      - sentences:
          - "(lüften|lueften)(modus|position|szene) <room_prep> {area}"
          - "{area} (lüften|lueften|lüftung)"
          - "<cover_type> zum (lüften|lueften) <room_prep> {area}"
          - "ich will (lüften|lueften) <room_prep> {area}"
          - "<room_prep> {area} (lüften|lueften)"
        slots:
          area:
            type: area
        response: "OK, Lüftungsposition in {{ slots.area }}."

  # --------------------------------------------------------------------------
  # STATUS ABFRAGEN
  # --------------------------------------------------------------------------
  GetCoverState:
    data:
      - sentences:
          - "(wie|was) (ist|sind|steht|stehen) <article> {name} [(rolladen|jalousie|rollo)]"
          - "(ist|sind) <article> {name} (offen|geschlossen|auf|zu)"
          - "auf wieviel [prozent] (ist|steht) <article> {name}"
          - "(wie weit|wieviel) (ist|sind) <article> {name} (offen|auf)"
          - "(status|position) [von|vom] {name}"
          - "{name} (status|position|wie weit)"
        slots:
          name:
            type: entity
            domain: cover
        response: >
          {% set pos = state_attr(slots.name, 'current_position') | default(0) %}
          {% if states(slots.name) == 'open' %}
          {{ state_attr(slots.name, 'friendly_name') }} ist offen bei {{ pos }}%.
          {% elif states(slots.name) == 'closed' %}
          {{ state_attr(slots.name, 'friendly_name') }} ist geschlossen.
          {% else %}
          {{ state_attr(slots.name, 'friendly_name') }}: {{ states(slots.name) }}, {{ pos }}%.
          {% endif %}
      
      - sentences:
          - "(ist|sind) <article> <cover_type> <room_prep> {area} (offen|geschlossen|auf|zu)"
          - "<cover_type> (status|position|zustand) <room_prep> {area}"
          - "wie (steht|stehen) <article> <cover_type> <room_prep> {area}"
        slots:
          area:
            type: area
        response: "Rolladen in {{ slots.area }}: Status wird abgefragt."