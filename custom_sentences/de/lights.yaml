# ================================================================================
# HA-GERMAN-VOICE - Deutsche Licht-Sprachbefehle
# ================================================================================
# TRUE STATE OF THE ART - Home Assistant 2024+ Syntax
# ✅ Entity Slots mit type: entity + domain filtering
# ✅ Area Slots mit type: area
# ✅ Responses direkt in Sentences
# ================================================================================

language: de

# ============================================================================
# EXPANSION RULES
# ============================================================================
expansion_rules:
  article: "[der|die|das|den|dem]"
  polite: "[bitte|mal|doch|eben]"
  room_prep: "(in|im|am|vom|beim)"

# ============================================================================
# LISTEN
# ============================================================================
lists:
  brightness:
    values:
      - in: "(0|null|aus)"
        out: 0
      - in: "(10|zehn)"
        out: 10
      - in: "(20|zwanzig)"
        out: 20
      - in: "(25|fünfundzwanzig|viertel)"
        out: 25
      - in: "(30|dreißig|dreissig)"
        out: 30
      - in: "(40|vierzig)"
        out: 40
      - in: "(50|fünfzig|fuenfzig|halb|halbe)"
        out: 50
      - in: "(60|sechzig)"
        out: 60
      - in: "(70|siebzig)"
        out: 70
      - in: "(75|fünfundsiebzig|dreiviertel)"
        out: 75
      - in: "(80|achtzig)"
        out: 80
      - in: "(90|neunzig)"
        out: 90
      - in: "(100|hundert|voll|volle|maximum)"
        out: 100

  color:
    values:
      - in: "(rot|rotes|rotem)"
        out: "red"
      - in: "(grün|gruen|grünes|grünem)"
        out: "green"
      - in: "(blau|blaues|blauem)"
        out: "blue"
      - in: "(gelb|gelbes|gelbem)"
        out: "yellow"
      - in: "(orange|oranges|orangem)"
        out: "orange"
      - in: "(lila|violett|violet|lila)"
        out: "purple"
      - in: "(rosa|pink)"
        out: "pink"
      - in: "(weiß|weiss|weißes|weissem)"
        out: "white"
      - in: "(warm|warmweiß|warmweiss)"
        out: "warmwhite"
      - in: "(kalt|kaltweiß|kaltweiss)"
        out: "coldwhite"
      - in: "(cyan|türkis|tuerkis)"
        out: "cyan"

  color_temp:
    values:
      - in: "(kalt|kühles|kuehles|kaltes|kühl|kuehl|tageslicht)"
        out: 153
      - in: "(neutral|normales|normal)"
        out: 300
      - in: "(warm|warmes|gemütlich|gemuetlich|gemütliches)"
        out: 400
      - in: "(sehr warm|kerzen|kerzenlicht)"
        out: 500

# ============================================================================
# INTENTS MIT ENTITY/AREA SLOTS + RESPONSES
# ============================================================================
intents:
  # --------------------------------------------------------------------------
  # LICHT AN
  # --------------------------------------------------------------------------
  HassTurnOn:
    data:
      # === Mit Entity-Name ===
      - sentences:
          - "(mach|schalte|stell|dreh|schalt) <polite> <article> {name} (an|ein)"
          - "<article> {name} (anschalten|einschalten|anmachen)"
          - "(licht|lampe|beleuchtung) (an|ein) {name}"
          - "{name} (licht|lampe) (an|ein)"
          - "(könntest|kannst|würdest) du <polite> <article> {name} (anmachen|einschalten)"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} ist an."
      
      # === Mit Area ===
      - sentences:
          - "(mach|schalte) <polite> [das] licht (an|ein) <room_prep> {area}"
          - "licht (an|ein) <room_prep> {area}"
          - "<room_prep> {area} licht (an|ein)"
          - "(hell|licht) <room_prep> {area}"
          - "{area} (beleuchten|erhellen)"
        slots:
          area:
            type: area
        response: "OK, Licht in {{ slots.area }} ist an."

  # --------------------------------------------------------------------------
  # LICHT AUS
  # --------------------------------------------------------------------------
  HassTurnOff:
    data:
      # === Mit Entity-Name ===
      - sentences:
          - "(mach|schalte|stell|dreh|schalt) <polite> <article> {name} (aus|ab)"
          - "<article> {name} (ausschalten|abschalten|ausmachen)"
          - "(licht|lampe|beleuchtung) (aus|ab) {name}"
          - "{name} (licht|lampe) (aus|ab)"
          - "(könntest|kannst|würdest) du <polite> <article> {name} (ausmachen|ausschalten)"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} ist aus."
      
      # === Mit Area ===
      - sentences:
          - "(mach|schalte) <polite> [das] licht (aus|ab) <room_prep> {area}"
          - "licht (aus|ab) <room_prep> {area}"
          - "<room_prep> {area} licht (aus|ab)"
          - "{area} (abdunkeln|dunkel)"
        slots:
          area:
            type: area
        response: "OK, Licht in {{ slots.area }} ist aus."

  # --------------------------------------------------------------------------
  # LICHT TOGGLE
  # --------------------------------------------------------------------------
  HassToggle:
    data:
      - sentences:
          - "(toggle|umschalten|wechsel|wechsle) <article> {name}"
          - "<article> {name} (toggle|umschalten)"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} umgeschaltet."

  # --------------------------------------------------------------------------
  # HELLIGKEIT SETZEN
  # --------------------------------------------------------------------------
  HassLightSet:
    data:
      # === Mit Entity-Name und Brightness ===
      - sentences:
          - "(setz|stell) <polite> <article> {name} [helligkeit] auf {brightness} [prozent]"
          - "<article> {name} auf {brightness} [prozent] [setzen|stellen|dimmen]"
          - "(dimm|dimme) <polite> <article> {name} auf {brightness} [prozent]"
          - "(mach|stell) <polite> <article> {name} [auf] {brightness} [prozent] [hell|dunkel]"
          - "<article> {name} helligkeit [auf] {brightness} [prozent]"
          - "{name} [auf] {brightness} [prozent]"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} auf {{ slots.brightness }}%."
      
      # === Mit Area und Brightness ===
      - sentences:
          - "(setz|stell) <polite> [die] helligkeit <room_prep> {area} auf {brightness} [prozent]"
          - "<room_prep> {area} [licht] [auf] {brightness} [prozent]"
          - "(dimm|dimme) <polite> <room_prep> {area} auf {brightness} [prozent]"
        slots:
          area:
            type: area
        response: "OK, Licht in {{ slots.area }} auf {{ slots.brightness }}%."
      
      # === Heller/Dunkler mit Entity ===
      - sentences:
          - "<article> {name} (heller|dunkler)"
          - "(mach|stell) <polite> <article> {name} (heller|dunkler)"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} angepasst."
      
      # === Heller/Dunkler mit Area ===
      - sentences:
          - "(heller|mehr licht) <room_prep> {area}"
          - "(dunkler|weniger licht|gedimmter) <room_prep> {area}"
        slots:
          area:
            type: area
        response: "OK, Helligkeit in {{ slots.area }} angepasst."

  # --------------------------------------------------------------------------
  # FARBE SETZEN
  # --------------------------------------------------------------------------
  HassLightSet:
    data:
      - sentences:
          - "(mach|stell|setz) <polite> <article> {name} [auf] {color}"
          - "<article> {name} [in|auf] {color} [setzen|stellen|ändern]"
          - "{color}[es] licht {name}"
          - "(änder|wechsel|wechsle) [die] farbe [von|der|des|am] {name} [auf|zu|nach] {color}"
          - "<article> {name} farbe [auf] {color}"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} auf {{ slots.color }}."
      
      - sentences:
          - "{color}[es] licht <room_prep> {area}"
          - "(änder|wechsel) [die] farbe <room_prep> {area} [auf|zu] {color}"
        slots:
          area:
            type: area
        response: "OK, Licht in {{ slots.area }} auf {{ slots.color }}."

  # --------------------------------------------------------------------------
  # FARBTEMPERATUR SETZEN
  # --------------------------------------------------------------------------
  HassLightSet:
    data:
      - sentences:
          - "(mach|stell) <polite> <article> {name} [auf] {color_temp}[es] [licht]"
          - "<article> {name} [auf] {color_temp}"
        slots:
          name:
            type: entity
            domain: light
        response: "OK, {{ slots.name }} auf {{ slots.color_temp }} Kelvin."
      
      - sentences:
          - "{color_temp}[es] licht <room_prep> {area}"
          - "<room_prep> {area} [licht] [auf] {color_temp}"
        slots:
          area:
            type: area
        response: "OK, Licht in {{ slots.area }} auf {{ slots.color_temp }} Kelvin."

  # --------------------------------------------------------------------------
  # ALLES AUS/AN
  # --------------------------------------------------------------------------
  HassTurnOff:
    data:
      - sentences:
          - "(mach|schalte) <polite> (alle|alles|sämtliche) (lichter|lampen|beleuchtung) (aus|ab)"
          - "(alle|alles|sämtliche) (lichter|lampen) (aus|ausschalten)"
          - "lichter (aus|ab)"
          - "licht überall (aus|ab)"
          - "alles dunkel"
        response: "OK, alle Lichter sind aus."

  HassTurnOn:
    data:
      - sentences:
          - "(mach|schalte) <polite> (alle|alles|sämtliche) (lichter|lampen|beleuchtung) (an|ein)"
          - "(alle|alles|sämtliche) (lichter|lampen) (an|einschalten)"
          - "lichter (an|ein)"
          - "licht überall (an|ein)"
          - "überall hell"
        response: "OK, alle Lichter sind an."

  # --------------------------------------------------------------------------
  # LICHT STATUS
  # --------------------------------------------------------------------------
  GetLightState:
    data:
      - sentences:
          - "(wie|was) (ist|sind) <article> {name} [(licht|lampe)]"
          - "(ist|sind) <article> {name} (an|aus|ein)"
          - "(status|helligkeit) [von|vom] {name}"
          - "{name} (status|helligkeit)"
          - "auf wieviel [prozent] (ist|steht) <article> {name}"
        slots:
          name:
            type: entity
            domain: light
        response: >
          {% set state = states(slots.name) %}
          {% set brightness = state_attr(slots.name, 'brightness') | default(0) %}
          {% set pct = (brightness / 2.55) | round %}
          {% if state == 'on' %}
          {{ state_attr(slots.name, 'friendly_name') }} ist an bei {{ pct }}%.
          {% else %}
          {{ state_attr(slots.name, 'friendly_name') }} ist aus.
          {% endif %}
